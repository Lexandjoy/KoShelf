{# Book Markdown Export Template #}

# {{ book.epub_info.title }}

{% if !book.epub_info.authors.is_empty() -%}
**Authors:** {{ book.epub_info.authors | join(", ") }}

{% endif -%}
{% match book_stats -%}
{% when Some with (stats) -%}
{% match stats.pages -%}
{% when Some with (pages) -%}
**Total Pages:** {{ pages }}

{% when None -%}
{% endmatch -%}
{% when None -%}
{% endmatch -%}
{% match book.series_display() -%}
{% when Some with (series) -%}
**Series:** {{ series }}

{% when None -%}
{% endmatch -%}
{% match book.language() -%}
{% when Some with (lang) -%}
**Language:** {{ lang }}

{% when None -%}
{% endmatch -%}
{% if !book.subjects().is_empty() -%}
**Subjects:** {{ book.subjects() | join(", ") }}

{% endif -%}
**Status:** {{ book.status() }}

**Progress:** {{ book.progress_percentage_display() }}%

{% match book.publisher() -%}
{% when Some with (publisher) -%}
**Publisher:** {{ publisher }}

{% when None -%}
{% endmatch -%}
{% match book.epub_info.sanitized_description() -%}
{% when Some with (description) -%}
## Description

<blockquote>
{{ description }}
</blockquote>

{% when None -%}
{% endmatch -%}
{% match book.rating() -%}
{% when Some with (rating) -%}
## My Rating

{% match rating -%}
{% when 1 -%}⭐☆☆☆☆ (1/5)
{% when 2 -%}⭐⭐☆☆☆ (2/5)
{% when 3 -%}⭐⭐⭐☆☆ (3/5)
{% when 4 -%}⭐⭐⭐⭐☆ (4/5)
{% when 5 -%}⭐⭐⭐⭐⭐ (5/5)
{% else -%}☆☆☆☆☆ (0/5)
{% endmatch -%}

{% when None -%}
{% endmatch -%}
{% match book.review_note() -%}
{% when Some with (review) -%}

## My Review

> {{ review }}

{% when None -%}
{% endmatch -%}
{% if book.highlight_count() > 0 -%}
## Highlights & Quotes ({{ book.highlight_count() }})

{% match book.koreader_metadata -%}
{% when Some with (metadata) -%}
{% for annotation in metadata.annotations -%}
{% if annotation.is_highlight() -%}
> {{ annotation.text }}

{% match annotation.note -%}
{% when Some with (note) -%}
**My Note:** {{ note }}

{% when None -%}
{% endmatch -%}
{% set has_location = false -%}
{% match annotation.chapter -%}
{% when Some with (chapter) -%}
{% match annotation.pageno -%}
{% when Some with (page) -%}
**Location:** {{ chapter }}, Page {{ page }}
{% set has_location = true -%}
{% when None -%}
**Location:** {{ chapter }}
{% set has_location = true -%}
{% endmatch -%}
{% when None -%}
{% match annotation.pageno -%}
{% when Some with (page) -%}
**Location:** Page {{ page }}
{% set has_location = true -%}
{% when None -%}
{% endmatch -%}
{% endmatch -%}
{% if has_location %}

{% endif -%}
{% endif -%}
{% endfor -%}
{% when None -%}
{% endmatch -%}
{% endif -%}
{% if book.bookmark_count() > 0 -%}
## Bookmarks ({{ book.bookmark_count() }})

{% match book.koreader_metadata -%}
{% when Some with (metadata) -%}
{% for annotation in metadata.annotations -%}
{% if annotation.is_bookmark() -%}
- **Bookmark**{% match annotation.chapter %}{% when Some with (chapter) %} - {{ chapter }}{% when None %}{% endmatch %}{% match annotation.pageno %}{% when Some with (page) %} (Page {{ page }}){% when None %}{% endmatch %}
{% if annotation.text != "" -%}
  - Text: {{ annotation.text }}
{% endif -%}
{% match annotation.note -%}
{% when Some with (note) -%}
  - **Note:** {{ note }}
{% when None -%}
{% endmatch -%}

{% endif -%}
{% endfor -%}
{% when None -%}
{% endmatch -%}
{% endif -%}
{% match session_stats -%}
{% when Some with (stats) -%}

## Reading Statistics
{% match book_stats -%}
{% when Some with (book_stat) -%}
{% match book_stat.total_read_time -%}
{% when Some with (time) -%}
- **Total read time:** {{ (time / 60) }} minutes
{% when None -%}
{% endmatch -%}
{% when None -%}
{% endmatch -%}
- **Total sessions:** {{ stats.session_count }}
- **Average session duration:** {% match stats.average_session_duration %}{% when Some with (dur) %}{{ (dur / 60) }} minutes{% when None %}--{% endmatch %}
- **Longest session:** {% match stats.longest_session_duration %}{% when Some with (dur) %}{{ (dur / 60) }} minutes{% when None %}--{% endmatch %}
- **Last read:** {% match stats.last_read_date %}{% when Some with (date) %}{{ date }}{% when None %}--{% endmatch %}
{% when None -%}
{% endmatch -%}
---

*Generated by KoShelf version {{ version }} on {{ last_updated }}.*